# conversation
åœ¨HAé‡Œä½¿ç”¨çš„å®˜æ–¹è¯­éŸ³åŠ©æ‰‹ä¿®æ”¹å¢å¼ºç‰ˆ


> å®˜æ–¹æ–‡æ¡£ï¼šhttps://www.home-assistant.io/integrations/conversation/

## é…ç½®
```yaml
# è¯­éŸ³å°åŠ©æ‰‹ï¼ˆé«˜çº§ç”¨æ³•è¯·å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼‰
conversation:

# æ—¥å¿—
logger:
  default: info
  logs:
    custom_components.conversation: debug
```

## äº‘éŸ³ä¹æŒ‡ä»¤ï¼ˆéœ€è¦é…åˆäº‘éŸ³ä¹æ’­æ”¾å™¨ä½¿ç”¨ï¼‰

- æˆ‘æƒ³å¬xxxçš„æ­Œ
- æ’­æ”¾(ç”µå°|æ­Œå•|æ­Œæ›²|ä¸“è¾‘)xxx
- ä¸‹ä¸€æ›²
- ä¸Šä¸€æ›²
- æ’­æ”¾éŸ³ä¹
- æš‚åœéŸ³ä¹
- å£°éŸ³å°ç‚¹ã€å°ç‚¹å£°éŸ³ã€å°ä¸€ç‚¹å£°éŸ³ã€å£°éŸ³å°ä¸€ç‚¹
- å£°éŸ³å¤§ç‚¹ã€å¤§ç‚¹å£°éŸ³ã€å¤§ä¸€ç‚¹å£°éŸ³ã€å£°éŸ³å¤§ä¸€ç‚¹

## æŒ‡ä»¤
- `æ‰“å¼€|å¼€å¯|å¯åŠ¨|å¼€ä¸‹|å¼€ä¸€ä¸‹|å…³é—­|å…³æ‰|å…³ä¸Š|å…³ä¸‹|å…³ä¸€ä¸‹|åˆ‡æ¢` `æ‰€æœ‰å¼€å…³|æ‰€æœ‰çš„å¼€å…³|å…¨éƒ¨å¼€å…³|å…¨éƒ¨çš„å¼€å…³|æ‰€æœ‰ç¯|æ‰€æœ‰çš„ç¯|å…¨éƒ¨ç¯|å…¨éƒ¨çš„ç¯`
- `æ‰“å¼€|å¼€å¯|å¯åŠ¨|å¼€ä¸‹|å¼€ä¸€ä¸‹|å…³é—­|å…³æ‰|å…³ä¸Š|å…³ä¸‹|å…³ä¸€ä¸‹|åˆ‡æ¢` `xç¯xxç¯xxxç¯`
- `æ‰“å¼€|å¼€å¯|å¯åŠ¨|å¼€ä¸‹|å¼€ä¸€ä¸‹|å…³é—­|å…³æ‰|å…³ä¸Š|å…³ä¸‹|å…³ä¸€ä¸‹|åˆ‡æ¢` `fanåç§°|climateåç§°|switchåç§°|lightåç§°|input_booleanåç§°`
- æŠŠ `fanåç§°|climateåç§°|switchåç§°|lightåç§°|input_booleanåç§°` `æ‰“å¼€|å¼€å¯|å¯åŠ¨|å¼€ä¸‹|å¼€ä¸€ä¸‹|å…³é—­|å…³æ‰|å…³ä¸Š|å…³ä¸‹|å…³ä¸€ä¸‹`
- æŠŠ `lightåç§°` `è°ƒæˆ|è®¾ä¸º|è®¾ç½®ä¸º|è°ƒä¸º` `çº¢|æ©™|é»„|ç»¿|é’|è“|ç´«|ç²‰|ç™½|ç´«çº¢|æ©„æ¦„|éšæœº` è‰²
- æŠŠ `lightåç§°` `è°ƒæˆ|è®¾ä¸º|è®¾ç½®ä¸º|è°ƒä¸º` `éšæœº|é—ªå…‰|é—ªçƒ|é¢œè‰²é—ªçƒ|å½©è™¹|è·‘é©¬ç¯|æ‰«æ|çƒŸç«` æ¨¡å¼
- æŠŠ `lightåç§°` çš„äº®åº¦ `è°ƒæˆ|è°ƒåˆ°|è°ƒä¸º|è®¾ä¸º` `1-100çš„æ•°å­—`
- æ‰§è¡Œè„šæœ¬ `scriptåç§°`
- `æ‰§è¡Œ|è§¦å‘|æ‰“å¼€|å…³é—­|åˆ‡æ¢`è‡ªåŠ¨åŒ–`automationåç§°`
- `æŸ¥çœ‹|æŸ¥è¯¢` `Entityåç§°`çš„çŠ¶æ€
- `æŸ¥çœ‹|æŸ¥è¯¢` `Entityåç§°`
- `Entityåç§°`çš„çŠ¶æ€

## æ‘„åƒç›‘æ§
- æŸ¥çœ‹xxxçš„ç”»é¢

## æ‰§è¡Œè„šæœ¬
- æ‰§è¡Œè„šæœ¬ï¼ˆè„šæœ¬åç§°=è¯­éŸ³æ–‡æœ¬ï¼‰

## node-red å’Œ è‡ªåŠ¨åŒ–
- ç›‘å¬ha_voice_text_eventäº‹ä»¶
- text: è¯­éŸ³æ–‡æœ¬

## æ›´æ–°æ—¥å¿—

### v1.4.5
- æ³¨æ„ï¼š`ä¿®æ”¹äº†é…ç½®æ–‡ä»¶æ ¼å¼ï¼Œå¿…éœ€è¦é‡æ–°é…ç½®`
- æ–°å¢python_scriptæœåŠ¡
- æ–°å¢ç”µè§†é¢‘é“è§£æ
- æ”¯æŒã€å¼€ä¸€ä¸‹ã€å¼€ä¸‹ã€å…³ä¸€ä¸‹ã€å…³ä¸‹ã€‘å‘½ä»¤
- æµ‹è¯•å°åº¦éŸ³ç®±æ§åˆ¶ç”µè§†åŠŸèƒ½
- æ–°å¢å°åº¦æ§åˆ¶ç”µè§†é¢‘é“è“å›¾
- æ–°å¢å°åº¦æ§åˆ¶å°ç±³ç©ºæ°”å‡€åŒ–å™¨æ¨¡å¼è“å›¾ï¼ˆç¡çœ æ¨¡å¼ã€è‡ªåŠ¨æ¨¡å¼ã€æ™ºèƒ½æ¨¡å¼ï¼‰
- æ–°å¢å°åº¦æ§åˆ¶å°ç±³ç¯æ³¡è‰²æ¸©æ§åˆ¶è“å›¾
- æ–°å¢å°åº¦æ§åˆ¶å°ç±³ç¯æ³¡æ¨¡å¼è“å›¾ï¼ˆç…§æ˜æ¨¡å¼ã€ä¼‘é—²/æ”¾æ¾æ¨¡å¼ã€é˜…è¯»æ¨¡å¼ã€å¤œç¯æ¨¡å¼ï¼‰
- ä¿®å¤å°åº¦æŸ¥è¯¢ç”µè§†çŠ¶æ€å¼‚å¸¸çš„é—®é¢˜
- æ”¯æŒå°åº¦è‡ªå®šä¹‰ç»„åˆåœºæ™¯

### v1.4.3
- é‡æ„è¯­éŸ³æ§åˆ¶é¡µé¢
- æµ‹è¯•å¤©çŒ«ç²¾çµ2.0æ¥å…¥
- åˆ é™¤ç”µå½±ç”µè§†å‰§ç›¸å…³åŠŸèƒ½
- ä¿®å¤æ— æ³•åˆ›å»ºé•¿ä»¤ç‰Œçš„é—®é¢˜
- å®Œå–„å¤©çŒ«ç²¾çµæ§åˆ¶æ™¾è¡£æ¶åŠŸèƒ½
- å®Œå–„å°åº¦éŸ³ç®±æ§åˆ¶ç©ºè°ƒåŠŸèƒ½

### v1.4.1
- æ”¯æŒå¤©çŒ«ç²¾çµè‡ªå®šä¹‰æŠ€èƒ½
- å¢åŠ æ–°å‘½ä»¤`æŠŠã€å®ä½“åç§°ã€‘ã€å¼€å…³å‘½ä»¤ã€‘`
- æ”¯æŒå°åº¦éŸ³ç®±

### v1.4
- æ’­æ”¾ç”µè§†å‰§å‘½ä»¤ä¿®æ”¹ä¸º`æ‰“å¼€ç”µè§†å‰§xxx`
- æ–°å¢`æ‰“å¼€ç”µå½±xxx`å‘½ä»¤
- ä½¿ç”¨å°çˆ±éŸ³ç®±æŸ¥è¯¢çŠ¶æ€æ—¶ï¼Œè®°å½•è¯­éŸ³å†…å®¹
- ä¿®å¤æ“ä½œå…¨éƒ¨ç¯çš„æ—¶å€™ï¼Œæ— æ³•æ“ä½œç¯å¸¦çš„é—®é¢˜
- é›†æˆè¯­éŸ³æ–‡ä»¶è¯†åˆ«æœåŠ¡ï¼ˆä»…æ”¯æŒæ ‘è“æ´¾32ä½ç³»ç»Ÿï¼‰
- æ”¯æŒåŒºåŸŸè¯†åˆ«
- æ”¯æŒfanå¼€å…³
- ä¿®å¤å°çˆ±åŒå­¦æŸ¥è¯¢å¼‚å¸¸çš„é—®é¢˜
### v1.3
- è§£å†³ä¸èƒ½æ“ä½œæ‰€æœ‰ç¯å’Œå¼€å…³çš„é—®é¢˜
- åŠ å…¥æŸ¥çœ‹æ‘„åƒç›‘æ§çš„ç”»é¢
- ä¿®å¤`conversation.process`æœåŠ¡æ²¡ä½œç”¨çš„é—®é¢˜
- å‡çº§`conversation`åˆ°å®˜æ–¹æœ€æ–°ç‰ˆæœ¬
- æ·»åŠ æ–‡æœ¬æ¥æºï¼ŒåŒºåˆ†å†…å®¹æ˜¯ä»å“ªé‡Œæ¥çš„
- å½“é¡µé¢ç‰ˆæœ¬ä¸ä¸€æ ·æ—¶ï¼Œè‡ªåŠ¨è·³è½¬åˆ°æœ€æ–°ç‰ˆæœ¬é¡µé¢
- è°ƒæ•´å¼€å…³è¯†åˆ«é€»è¾‘
- æ›´æ¢æ–°ç‰ˆå›¾æ ‡
- æ”¯æŒå°çˆ±åŒå­¦è‡ªå®šä¹‰æŠ€èƒ½
- æ”¯æŒç¯å…‰é¢œè‰²æ§åˆ¶ï¼ˆçº¢ã€æ©™ã€é»„ã€ç»¿ã€é’ã€è“ã€ç´«ã€ç²‰ã€ç™½ã€ç´«çº¢ã€æ©„æ¦„ã€éšæœºï¼‰
- æ”¯æŒç¯å…‰äº®åº¦æ§åˆ¶
- æ”¯æŒç¯å…‰æ¨¡å¼æ§åˆ¶
- æ”¯æŒç”µè§†æŠ•å±åŠŸèƒ½
- è®°å½•è¯­éŸ³æ–‡æœ¬
- æ”¯æŒä¸€æ¬¡æ€§æ‰“å¼€å…³é—­å¤šä¸ªè®¾å¤‡
- æ”¯æŒè¯­éŸ³ç»“æŸåæ˜¯å¦ç»§ç»­å¼€éº¦æ§åˆ¶
- æ”¯æŒå¼€å¯å…³é—­åŒæ—¶æ“ä½œ
- æ”¯æŒæ‰“å¼€å…³é—­ç©ºè°ƒè®¾å¤‡
- ä¿®å¤å°çˆ±åŒå­¦ä¸èƒ½é€€å‡ºçš„é—®é¢˜
- åŠ å…¥äº’è”ç½‘è§†é¢‘åŠŸèƒ½
- å°çˆ±æ¥å£åŠ å…¥æœ¬æœºMACæ ‡è¯†ï¼Œå¢å¼ºå®‰å…¨æ€§
- å¢åŠ è¯»å–æœ¬åœ°è§†é¢‘æœåŠ¡
- ä¿®å¤æ— æ³•åŒ¹é…æŸ¥è¯¢çŠ¶æ€çš„é—®é¢˜

### v1.2
- åŠ å…¥å•ç‹¬çš„èŠå¤©ç•Œé¢
- æ”¯æŒ`python_script.conversation`æœåŠ¡ï¼Œæ¥æ”¶`text`å‚æ•°
- ä¼˜åŒ–èŠå¤©ç•Œé¢ç™»å½•é€»è¾‘

### v1.1
- ä¼˜åŒ–ä»£ç ç»“æ„
- å¢åŠ é‡è½½æœåŠ¡ï¼ˆä¿®æ”¹é…ç½®ä¸ç”¨é‡å¯ï¼‰

### v1.0
- å½“è¯­éŸ³æ–‡æœ¬ä¸è„šæœ¬åç§°ä¸€è‡´æ—¶ï¼Œåˆ™è§¦å‘è„šæœ¬
- è¯­éŸ³æ–‡æœ¬åŒ¹é…å¤šä¸ªå†…å®¹æ—¶ï¼Œè„šæœ¬åç§°ä½¿ç”¨=å·åˆ†éš”
- å®šä¹‰ha_voice_text_eventäº‹ä»¶å‘é€æ–‡æœ¬
- è¯­éŸ³æ”¯æŒï¼šæ·»åŠ xxxåˆ°æˆ‘çš„è´­ç‰©å•
- è¯­éŸ³æ”¯æŒï¼šæˆ‘çš„è´­ç‰©å•ä¸Šæœ‰ä»€ä¹ˆ
- é›†æˆèŠå¤©æœºå™¨äºº


## æ ‘è“æ´¾è®¯é£è¯­éŸ³è¯†åˆ«

åªåœ¨æ ‘è“æ´¾32ä½ç³»ç»Ÿä¸­å¯ç”¨

```yaml
# è¿”å›è¯†åˆ«ç»“æœ
voice: http://192.168.1.101:8123/conversation-xunfei-xxxxxx

# ç›´æ¥è¯†åˆ«
voice: http://192.168.1.101:8123/conversation-xunfei-xxxxxx?type=conversation
voice_time: 2
```

## æ„å›¾é…ç½®
æ³¨æ„ï¼šå°çˆ±è‡ªå®šä¹‰æŠ€èƒ½é…ç½®æ²¡æœ‰@ç¬¦å·
```
æŠŠ@{text}
æ‰“å¼€@{text}
å¯åŠ¨@{text}
å¼€@{text}
å…³@{text}
åˆ‡æ¢@{text}
è§¦å‘@{text}
æ‰§è¡Œ@{text}
æŸ¥çœ‹@{text}
æŸ¥è¯¢@{text}
ä¸‹ä¸€æ›²
ä¸‹ä¸€é¦–
ä¸Šä¸€æ›²
ä¸Šä¸€é¦–
æ’­æ”¾@{text}
æš‚åœ@{text}
å£°éŸ³@{text}
å°@{text}
```

## å°åº¦è‡ªå®šä¹‰é€šç”¨å±æ€§

```yaml
# å¼€å…³ç±»å‹æ”¹ä¸ºæ’åº§ç±»å‹
xiaodu_type: SOCKET

# scriptæ¨¡æ‹Ÿç”µè§†
xiaodu_name: ç”µè§†
xiaodu_domain: media_player

# sensorä¼ æ„Ÿå™¨
xiaodu_name: æ¸©åº¦ä¼ æ„Ÿå™¨

xiaodu_name: æ¹¿åº¦ä¼ æ„Ÿå™¨

# æ‘„åƒå¤´ï¼ˆCAMERAã€WEBCAMï¼‰
xiaodu_name: æ‘„åƒå¤´
xiaodu_type: WEBCAM
xiaodu_domain: camera

# automationåœºæ™¯ï¼ˆæ‰“å¼€ã€å…³é—­ï¼‰
xiaodu_name: éŸ³ä¹æ¨¡å¼
xiaodu_domain: scene

# automationåœºæ™¯ï¼ˆæ‰“å¼€ã€å…³é—­ï¼‰
xiaodu_name: éŸ³ä¹æ¨¡å¼
xiaodu_domain: scene
```

> å°åº¦å¼€å‘ç›¸å…³æ–‡æ¡£

- [è®¾å¤‡ç±»å‹ä¸æ¨¡å¼è¡¨](https://dueros.baidu.com/didp/doc/dueros-bot-platform/dbp-smart-home/protocol/control-message_markdown#%E8%AE%BE%E5%A4%87%E7%B1%BB%E5%9E%8B%E4%B8%8E%E6%A8%A1%E5%BC%8F%E8%A1%A8)


## å¤©çŒ«ç²¾çµ2.0

- [å¼€æ”¾å¹³å°](https://iot.aligenie.com/home)
- [å¼€å‘æ–‡æ¡£](https://www.yuque.com/qw5nze/ga14hc/cmhq2c)

é…ç½®æ³¨æ„äº‹é¡¹ï¼š`æŠ€èƒ½å›¾æ–‡å†…å®¹`è¦å…¨éƒ¨å¡«å†™æ‰èƒ½ç”Ÿæ•ˆ

```yaml
# å¼€å…³ç±»å‹æ”¹ä¸ºæ’åº§ç±»å‹
tmall_type: outlet
```

## å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·æˆ‘å–æ¯<del><small>å’–å•¡</small></del><b>å¥¶èŒ¶</b>å§ğŸ˜˜
|æ”¯ä»˜å®|å¾®ä¿¡|
|---|---|
<img src="https://ha.jiluxinqing.com/img/alipay.png" align="left" height="160" width="160" alt="æ”¯ä»˜å®" title="æ”¯ä»˜å®">  |  <img src="https://ha.jiluxinqing.com/img/wechat.png" align="left" height="160" width="160" alt="å¾®ä¿¡æ”¯ä»˜" title="å¾®ä¿¡">